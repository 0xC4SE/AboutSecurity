# 出报告专用

---

最后修改时间 2020-3-3

---

## 修复建议

**认证**

- 对于存在弱口令的系统，需在加强使用者安全意识的前提下，督促其修改密码，或者使用策略来强制限制密码长度和复杂性。
- 对于存在弱口令或是空口令的服务，在一些关键服务上，应加强口令强度，同时需使用加密传输方式，对于一些可关闭的服务来说，建议关闭该服务以达到安全目的。
- 对于出现验证码功能的系统，不能只在前端进行防护，而是要在后台进行二次检测，做到前后端同时加固。

**应用**

- 对于 Oracle 相关应用,建议及时更新到最新版本,安装最新补丁,详情可见官方安全公告 https://www.oracle.com/security-alerts/
- 对于 Struts2 应用,管理员需及时关注官方的安全公告 https://cwiki.apache.org/confluence/display/WW/Security+Bulletins
- 对于 Harbor 应用,管理员需及时关注官方的安全公告 https://github.com/goharbor/harbor/security/advisories
- 对于 jira 应用,管理员需及时关注官方的安全公告 https://jira.atlassian.com/browse/JRASERVER-69858?filter=13085
- 对于 Weblogic 相关应用,建议及时更新到最新版本,安装最新补丁,详情可见官方安全公告 https://www.oracle.com/security-alerts/
- 对于 shiro 应用,管理员需及时关注官方的安全公告 https://issues.apache.org/jira/projects/SHIRO/issues
- 对于 Solr 应用,管理员需及时关注官方的安全公告 https://issues.apache.org/jira/projects/SOLR/issues
- 对于 jenkins 应用,管理员需及时关注官方的安全公告 https://jenkins.io/security/advisories/

**主机**

- 对于 Windows 主机的漏洞防护,管理员需及时关注微软官方的安全公告 https://portal.msrc.microsoft.com/zh-cn/security-guidance
- 对于 UNIX 主机的漏洞防护,管理员需关注相应发行版本官方安全公告

---

# 认证
## 弱口令/空口令

**web 后台系统弱口令**

`漏洞评级建议: 高危`

- 详情
    > 渗透测试过程中，发现目标 web 后台管理存在弱口令组合。

- 造成的危害:
    > 攻击者利用弱口令登录网站管理后台，可对数据进行恶意的增删改等操作，从而造成一定破坏。

- 修复建议
    ```
    1. 管理员账号不要采用弱口令，建议密码强度 8 位以上，大小写数字混合。
    2. 对于管理类系统配置登陆用户允许的 IP 范围
    3. 针对登陆次数进行限制，可使用登陆远程 IP 或用户名两种方式进行锁定，登录错误次数 5 分钟之内超过 3 次锁定 1-3 小时。
    ```

**ftp 弱口令**

`漏洞评级建议: 高危,若无实际利用点建议降为中危`

- 详情
    > 渗透测试过程中，发现远程 FTP Server 允许以弱口令组合登录。

- 造成的危害:
    > 这可能允许攻击者上传恶意文件或者下载敏感文件。

- 修复建议
    > FTP 服务如果不是必须使用，可以关闭，或更新到最新版本，并不要采用弱口令。

**ftp 匿名登陆**

`漏洞评级建议: 高危,若无实际利用点建议降为中危`

- 详情
    > 渗透测试过程中，发现目标主机开放的 ftp 服务允许匿名用户进行登录。

- 造成的危害:
    > 黑客利用弱口令或匿名登录漏洞直接登录 FTP 服务，上传恶意文件，从而获取系统权限，并可能造成数据泄露。

- 修复建议
    > FTP 服务如果不是必须使用，可以关闭，或更新到最新版本，并关闭匿名访问。

**SSH 弱口令**

`漏洞评级建议: 高危`

- 详情
    > SSH 弱口令漏洞指 Linux 系统口令的长度太短或者复杂度不够，如仅包含数字，或仅包含字母等，弱口令容易被破解。攻击者可以利用弱口令直接登录SSH服务器，读取甚至修改网站代码，或者导致服务器沦陷。

- 造成的危害:
    > 攻击者经过爆破登陆后可完全控制机器，即使低权限账号也可以通过提权进行进一步的破坏。

- 修复建议
    ```
    1. 修改口令，增加口令复杂度，如包含大小写字母、数字和特殊字符等。
    2. 修改默认口令，避免默认口令被猜解。
    3. 指定健壮的口令策略，比如指定每隔30天修改一次密码，密码不得与历史密码相同。
    ```

**数据库弱口令**

`漏洞评级建议: 高危`

- 详情
    > 数据库弱口令漏洞指数据库管理员账号对应密码的长度太短或者复杂度不够，仅包含数字，或仅包含字母等，弱口令容易被破解，一旦被攻击者获取，可用来直接登录数据库系统，读取甚至修改服务器上的文件，或者导致服务器沦陷。

- 造成的危害:
    > 攻击者可直接操作数据库,甚至可以进行提权拿到服务器权限。

- 修复建议
    ```
    1. 修改口令，增加口令复杂度，如包含大小写字母、数字和特殊字符等。
    2. 修改默认口令，避免默认口令被猜解。
    3. 指定健壮的口令策略，比如指定每隔30天修改一次密码，密码不得与历史密码相同。
    ```

**xxx 弱口令/空口令**

`漏洞评级建议: 高危,若无实际利用点建议降为中危`

- 详情
    > 渗透测试过程中，发现目标服务器存在 xxx 服务弱口令问题。

- 造成的危害:
    > 攻击者经过爆破登陆后可完全控制机器，即使低权限账号也可以通过提权进行进一步的破坏。

    或

    > 攻击者经过爆破登陆后可完全控制目标数据库，进而可以对数据信息进行窃取、篡改等操作。

- 修复建议
    ```
    1. 账号不要采用弱口令，建议密码强度 8 位以上，大小写数字混合。
    2. 只允许可信 IP 进行连接。
    ```

**xxx 后台无安全认证**

`漏洞评级建议: 高危,若无实际利用点建议降为中危`

- 详情
    > 渗透测试过程中，发现目标xxx服务无任何安全认证。

- 造成的危害:
    > 攻击者进入管理后台可以获取目标业务信息，甚至对其系统进行一定修改破坏。

- 修复建议
    ```
    1. xxx 服务后台加上安全认证。
    2. 对于管理类系统配置登陆用户允许的 IP 范围
    3. 账号不要采用弱口令，建议密码强度 8 位以上，大小写数字混合。
    4. 针对登陆次数进行限制，可使用登陆远程 IP 或用户名两种方式进行锁定，登录错误次数 5 分钟之内超过 3 次锁定 1-3 小时。
    ```

## 存在风险

**爆破风险**

`漏洞评级建议: 低危,若无实际利用点建议降为信息`

- 详情
    > 在后台登录页面，登录时错误提示信息明确，因此可以判断用户名是否存在，然后针对用户名进行暴力破解。

    或

    > 在后台登录页面，登录时错误提示信息明确，且未对登录失败做访问控制，导致攻击者可以进行持续暴力破解登录口令。

- 造成的危害:
    > 攻击者可以针对某已知用户名进行慢速暴力破解，从而进入后台。

- 修复建议
    ```
    1. 修改错误提示信息，加强逻辑认证。
    2. 针对登陆次数进行限制，可使用登陆远程 IP 或用户名两种方式进行锁定，登录错误次数 5 分钟之内超过 3 次锁定 1-3 小时。
    3. 对于管理类系统配置登陆用户允许的 IP 范围
    ```

**验证码可绕过**

`漏洞评级建议: 低危,若无实际利用点建议降为信息`

- 详情
    > 在后台登录页面，验证码只在前台 js 校验，攻击者在爆破账号可以进行绕过。

    或

    > 在后台登录页面，验证码只验证一次，攻击者只需截取第一个包即可进行绕过实施账号爆破。

- 造成的危害:
    > 由于可以绕过验证码，导致攻击者对后台的爆破难度大大降低。

- 修复建议
    ```
    1. 将验证码判断放在后端进行。
    2. 针对登陆次数进行限制，可使用登陆远程 IP 或用户名两种方式进行锁定，登录错误次数 5 分钟之内超过 3 次锁定 1-3 小时
    3. 对于管理类系统配置登陆用户允许的 IP 范围
    ```

---

# 主机
## windows

**MS12-020**

`漏洞评级建议: 高危`

- 详情
    > MS12-020 漏洞是微软在 12 年发布的一个 windows 系统漏洞，该漏洞针对于windows xp 和 windows sever 2003 等系统。攻击者通过该漏洞对目标主机进行攻击，可导致目标主机蓝屏。

- 造成的危害:
    > 远程攻击者在未经认证的情况下往服务器发送畸形恶意的数据包，便可以以系统权限或者 NET SERVICE 权限执行任意命令。

- 修复建议
    > 针对 MS12-020 漏洞，微软官方已放出相应的补丁，建议及时安装官方补丁:http://technet.microsoft.com/en-us/security/bulletin/ms12-020

**MS14-066**

`漏洞评级建议: 高危`

- 详情
    > 目标主机存在 MS14-066 漏洞，由于安全通道（Schannel）安全包对包的处理不当，远程Windows主机受到远程代码执行漏洞的影响。

- 造成的危害:
    > 攻击者可以通过将特制数据包发送到Windows服务器来利用此漏洞。

- 修复建议
    > 针对 MS14-066 漏洞，微软官方已放出相应的补丁，建议及时安装官方补丁:https://docs.microsoft.com/en-us/security-updates/securitybulletins/2014/ms14-066

**MS15-034**

`漏洞评级建议: 高危`

- 详情
    > 目标主机存在 MS15-034 漏洞，如果攻击者向受影响的 Windows 系统发送经特殊设计的的 HTTP 请求，此漏洞可能允许远程执行代码。

- 造成的危害:
    > 利用 HTTP.sys 的安全漏洞，攻击者只需要发送恶意的 http 请求数据包，就可能远程读取 IIS 服务器的内存数据，或使服务器系统蓝屏崩溃。

- 修复建议
    > 针对 MS15-034 漏洞，微软官方已放出相应的补丁，建议及时安装官方补丁：https://docs.microsoft.com/zh-cn/security-updates/securitybulletins/2015/ms15-034

**MS17-010**

`漏洞评级建议: 高危`

- 详情
    > 目标主机存在 MS17-010 漏洞。如果攻击者向 Windows SMBv1 服务器发送特殊设计的消息，那么其中最严重的漏洞可能允许远程执行代码。

- 造成的危害:
    > 该漏洞是 Windows 的 SMB 服务处理 SMB v1 请求时发生的漏洞，这个漏洞导致攻击者可以使用该漏洞使目标机器反代连接到 cc 服务器，进行远程控制主机、在局域网传播木马等破坏行为。

- 修复建议
    > 针对 MS17-010 漏洞，微软官方已放出相应的补丁，建议及时安装官方补丁:https://docs.microsoft.com/zh-cn/security-updates/securitybulletins/2017/ms17-010

**CVE-2019-0708 漏洞**

`漏洞评级建议: 高危`

- 详情
    > 目标主机存在 Windows 高危远程漏洞 CVE-2019-0708。当未经身份验证的攻击者使用 RDP 连接到目标系统并发送经特殊设计的请求时，远程桌面服务（以前称为“终端服务”）中存在远程执行代码漏洞。此漏洞是预身份验证，无需用户交互。

- 造成的危害:
    > 攻击者一旦成功利用该漏洞，便可以在目标系统上执行任意代码，包括获取敏感信息、执行远程代码、发起拒绝服务攻击等等攻击行为。

- 修复建议
    ```
    针对 CVE-2019-0708 漏洞，Microsoft 已经为此发布了一个安全公告以及相应补丁:
    https://portal.msrc.microsoft.com/zh-CN/security-guidance/advisory/CVE-2019-0708
    https://support.microsoft.com/en-us/help/4500331/windows-update-kb4500331
    ```

---

# 应用
## web
### 常见

**文件上传类**

`漏洞评级建议: 高危`

- 详情
    > 测试过程中发现目标站点存在文件上传漏洞,上传文件时，如果未对上传的文件进行严格的验证和过滤，就容易造成文件上传漏洞，上传脚本等。

- 造成的危害:
    > 攻击者通过上传恶意文件可能导致网站被控制，甚至可以进一步的进行提权，控制目标机器，进入目标内网。

- 修复建议
    ```
    1. 限制文件上传类型。
    2. 限制上传文件大小。
    3. 确保上传文件被访问正确返回。
    4. 确保上传的文件放在安全的路径下，必要时可以将上传的文件存在 web server 之外的远程服务器。
    5. 设置项目目录权限:可写目录不执行，执行目录不可写。
    ```

**任意文件下载**

`漏洞评级建议: 高危`

- 详情
    > 由于未对用户查看或下载的文件做限制，恶意用户就能够查看或下载任意的文件，可以是源代码文件、敏感文件等、如脚本代码、服务及系统配置文件等。

- 造成的危害:
    > 攻击者可用得到的代码进一步代码审计，得到更多可利用漏洞。

- 修复建议
    ```
    1. 过滤.(点)，使用户在url中不能回溯上级目录。
    2. 正则严格判断用户输入参数的格式，限定用户访问范围。
    3. 将下载区独立出来，放在项目路径外，给每个下载资源固定的URL，而不是所有的下载资源都是统一的URL。
    ```

**任意文件删除**

`漏洞评级建议: 高危`

- 详情
    > 渗透测试过程中，发现目标存在一处操作接口，可导致任意文件删除操作。

- 造成的危害:
    > 攻击者可利用该接口删除网站任意文件，从而对目标系统造成巨大破坏。

- 修复建议
    ```
    1. 过滤关键字符
    2. 避免由外界指定文件名、路径
    3. 做好权限控制
    ```

**目录浏览(目录遍历)**

`漏洞评级建议: 中危,造成影响非常严重建议高危`

- 详情
    > 目录遍历(路径遍历)是由于 web 服务器或者 web 应用程序对用户输入的文件名称的安全性验证不足而导致的一种安全漏洞。

- 造成的危害:
    > 攻击者通过利用一些特殊字符就可以绕过服务器的安全限制，访问任意的文件(可以使 web 根目录以外的文件)，甚至执行系统命令。

- 修复建议
    ```
    1. 避免由外界指定文件名。
    2. 文件名中不可以包含目录。
    3. 限定文件名中仅包含字母与数字。
    4. 指定可以访问的白名单。
    ```

**任意文件包含**

- 详情
    > 通过引入文件时，引用的文件名，用户可控，由于传入的文件名没有经过合理的校验，或者检验被绕过，从而操作了预想之外的文件，就可能导致意外的文件泄露甚至恶意的代码注入。

- 造成的危害:
    > 攻击者可以通过枚举获得服务器上的敏感文件,配合文件上传功能甚至可以直接获得服务器权限。

- 修复建议
    ```
    1. php中可以使用open_basedir配置限制访问权限在指定区域。
    2. 过滤 . (点) / (斜杠) \ (反斜杠)。
    3. 禁止服务器远程文件包含。
    ```

**csrf**

`漏洞评级建议: 高危`

- 详情
    > CSRF是跨站请求伪造，不攻击网站服务器，而是冒充用户在站内的正常操作。通常由于服务端没有对请求头做严格过滤引起的。CSRF会造成密码重置，用户伪造等问题，可能引发严重后果。

- 造成的危害:
    > CSRF 攻击可以在受害者毫不知情的情况下以受害者名义伪造请求发送给受攻击站点，从而在并未授权的情况下执行在权限保护之下的操作。

- 修复建议
    ```
    1. 验证 HTTP Referer 字段
    2. 在请求地址中添加 token 并验证
    3. 在 HTTP 头中自定义属性并验证
    4. 对于web站点，将持久化的授权方法（例如 cookie 或者 HTTP 授权）切换为瞬时的授权方法（在每个 form 中提供隐藏field），可以帮助网站防止 CSRF 攻击。
    ```

**SSRF**

`漏洞评级建议: 高危`

- 详情
    > 很多 web 应用都提供了从其他的服务器上获取数据的功能。使用用户指定的 URL，web 应用可以获取图片，下载文件，读取文件内容等。这个功能如果被恶意使用，可以利用存在缺陷的 web 应用作为代理攻击远程和本地的服务器。这种形式的攻击称为服务端请求伪造攻击(Server-side Request Forgery)。

- 造成的危害:
    > 攻击者可以利用存在缺陷的 web 应用作为代理攻击远程和本地的服务器。

- 修复建议
    ```
    1. 限制返回信息格式。
    2. 避免回显，删除或统一错误信息。
    3. 黑名单内网 ip 地址。
    4. 只允许使用 http 和 https 协议。
    ```

### 信息泄露类

**测试系统环境开放**

`漏洞评级建议: 中危`

- 详情
    > 渗透测试过程中，发现目标测试系统访问对公网开放，无任何安全认证措施。

- 造成的危害:
    > 即使是测试系统也可能会存在一定的敏感数据，而且攻击者也可能通过拿下测试系统的机器近一步的横向渗透，对整个业务系统造成极大影响。

- 修复建议
    > 停止对外开放测试系统,并检查有无同类系统存在该问题。

**某查询接口造成用户信息泄露**

`漏洞评级建议: 高危`

- 详情
    > 在 xxxx 页面时，经过更改的查询请求可以绕过查询限制，从而查询到任意用户的缴费数据。

- 造成的危害:
    > 恶意分子通过批量查询用户信息，导致用户 xxxx 信息泄漏，可以对用户实施钓鱼、诈骗等。甚至用于黑产。

- 修复建议
    > 对查询请求做好检查和限制。

**配置文件泄露**

`漏洞评级建议: 高危`

- 详情
    > 目标网站存在配置文件泄露问题，包含部分项目文件路径信息、配置参数信息等。

- 造成的危害:
    > 泄露的配置文件可能会包含路径信息，甚至可能包含部分数据库配置参数。

- 修复建议
    > 修改配置文件使目标路径不可访问。

**phpinfo 信息泄露**

`漏洞评级建议: 信息`

- 详情
    > PHPInfo 信息泄露漏洞常发生一些默认的安装包，比如 phpstudy 等，默认安装完成后，没有及时删除这些提供环境测试的文件，比较常见的为 phpinfo.php、1.php 和 test.php， 主要用于网站建设过程中测试搭建的 PHP 环境是否正确，很多网站在测试完毕后并没有及时删除，因此当访问这些测试页面时，会输出服务器的关键信息，这些信息的泄露将导致服务器被渗透的风险。

- 造成的危害:
    > phpinfo 返回的信息中包含了服务器的配置信息，包括:1.PHP编译选项以及文件扩展名的相关信息;2.php 的版本信息;3.php 的配置信息;4.数据库信息等敏感信息。这些敏感信息会帮助攻击者展开进一步的攻击。PHP中提供了 PHPInfo() 函数，该函数返回 PHP 的所有信息，包括了 PHP 的编译选项及扩充配置、PHP 版本、服务器信息及环境变量、PHP 环境变量、操作系统版本信息、路径及环境变量配置、HTTP 标头、及版权宣告等信息。

- 修复建议
    > 建议移除 phpinfo 文件。

**svn 源码泄露漏洞**

`漏洞评级建议: 中危,若无实际项目文件建议降为信息`

- 详情
    > Subversion，简称 SVN，是一个开放源代码的版本控制系统，相对于的 RCS、CVS，采用了分支管理系统，它的设计目标就是取代 CVS。互联网上越来越多的控制服务从 CVS 转移到 Subversion。在服务器上布署代码时。如果是使用 svn checkout 功能来更新代码，而没有配置好目录访问权限，则会存在此漏洞。

- 造成的危害:
    > 黑客可以借助其中包含的用于版本信息追踪的‘entries’文件，逐步摸清站点结构。"(可以利用.svn/entries文件，获取到服务器源码、svn服务器账号密码等信息)更严重的问题在于，SVN产生的.svn目录下还包含了以.svn-base结尾的源代码文件副本(低版本SVN具体路径为text-base目录，高版本SVN为pristine目录)，如果服务器没有对此类后缀做解析，黑客则可以直接获得文件源代码。

- 修复建议
    ```
    1. 查找服务器上所有 .svn 隐藏文件夹，删除。
    2. 开发人员在使用 SVN 时，严格使用导出功能。禁止直接复制代码。
    ```

**CVS 存储库文件泄露**

`漏洞评级建议: 中危,若无实际项目文件建议降为信息`

- 详情
    > cvs 项目在初始化(cvs checkout project)的时候, 会在 project 目录下创建一个名为 CVS 的目录,其中保存了各个文件的修改和 commit 记录. 通过此目录可以获取代码的历史版本. 其中两个关键文件为:CVS/Root 和 CVS/Entries, 分别记录了项目的根信息和所有文件的结构。

- 造成的危害:
    > 通过此目录可以获取代码的历史版本.泄露源代码。

- 修复建议
    > 删除相应文件夹,使用其他版本控制工具.

**.git 源码泄漏**

`漏洞评级建议: 中危,若无实际项目文件建议降为信息`

- 详情
    > 在运行 git init 初始化代码库的时候，会在当前目录下面产生一个 .git 的隐藏文件，用来记录代码的变更记录等等。在发布代码的时候，把 .git 这个目录没有删除，直接发布了。使用这个文件，可以用来恢复源代码。

- 造成的危害:
    > 如果配置不当，可能会将 .git 文件夹直接部署到线上环境，这就引发了 git 泄露漏洞，攻击者可以直接从源码获取敏感配置信息。

- 修复建议
    > 查找服务器上所有 .git 隐藏文件夹，删除。

### 逻辑类漏洞

**越权漏洞**

`漏洞评级建议: 视情况而定,水平越权默认中危,垂直越权默认高危`

- 详情
    > 越权漏洞是比较常见的漏洞类型，越权漏洞可以理解为，一个正常的用户A通常只能够对自己的一些信息进行增删改查，但是由于程序员的一时疏忽，对信息进行增删改查的时候没有进行一个判断，判断所需要操作的信息是否属于对应的用户，可以导致用户A可以操作其他人的信息。​

- 修复建议
    ```
    1. 日常开发中要多留意业务逻辑可能出现的漏洞和水平权限漏洞或者其它未发现的漏洞。
    2. 鉴权，服务端对请求的数据和当前用户身份做校验;完善基础安全架构，完善用户权限体系。
    ```

**支付数据可被篡改**

`漏洞评级建议: 高危`

- 详情
    > 填写完缴款页面，在进入网银缴费页面前，确认缴费信息时，可通过 burpsuite 软件篡改本地缴费金额，欺骗本地缴费系统，以达到以少付多的效果。

- 造成的危害:
    > 例如某机关单位张三缴款时利用该漏洞缴款 100000 元，本地篡改数据为 0.1 元，即可完成只花费 0.1 元实现 100000 元的缴款。

- 修复建议
    > 取消支付页面的 http 访问，调整支付逻辑。并且后端复查实际金额。

**短信验证码接口可被利用**

`漏洞评级建议: 中危`

- 详情
    > 在用户注册页面， 其发所短信验证码接口未做限制，导致重复发包时可以绕过前台时间限制。

- 造成的危害:
    > 攻击者可以重复 post 请求，针对某手机号进行短信轰炸。

- 修复建议
    ```
    1. 将短信验证码时间限制判断放在后端进行。
    2. 同一手机号，60秒内不能重复发送，24小时内总共发送不超过5次。
    3. 加上 IP 限制，例如某 IP 一小时内连续登录发送 3 次，6 个小时内禁止该 ip 发送。
    ```

### Fuzz

**XSS**

`漏洞评级建议: 高危`

- 详情
    > XSS 又称 CSS，全称 Cross SiteScript，跨站脚本攻击，是 Web 程序中常见的漏洞，XSS 属于被动式且用于客户端的攻击方式，所以容易被忽略其危害性。其原理是攻击者向有 XSS 漏洞的网站中输入(传入)恶意的 HTML 代码，当其它用户浏览该网站时，这段 HTML 代码会自动执行，从而达到攻击的目的。如，盗取用户 Cookie、破坏页面结构、重定向到其它网站等。

- 造成的危害:
    > 攻击者可在网址中插入特定的 XSS 代码，将访客的 cookie 等信息发送到远程 C&C 服务器，从而窥探用户隐私甚至财产。

- 修复建议
    ```
    1. 不信任用户提交的任何内容，对所有用户提交内容进行可靠的输入验证，包括对 URL、查询关键字、HTTP 头、REFER、POST 数据等，仅接受指定长度范围内、采用适当格式、采用所预期的字符的内容提交，对其他的一律过滤。尽量采用 POST 而非 GET 提交表单;对"<"，">"，";"，"""等字符做过滤;任何内容输出到页面之前都必须加以 en-code，避免不小心把 htmltag 显示出来。
    2. 实现 Session 标记(session tokens)、CAPTCHA(验证码)系统或者 HTTP 引用头检查，以防功能被第三方网站所执行，对于用户提交信息的中的 img 等 link，检查是否有重定向回本站、不是真的图片等可疑操作。
    3. cookie 防盗。避免直接在 cookie 中泄露用户隐私，例如 email、密码，等等;通过使 cookie 和系统 IP 绑定来降低 cookie 泄露后的危险。这样攻击者得到的 cookie 没有实际价值，很难拿来直接进行重放攻击。
    4. 确认接收的内容被妥善地规范化，仅包含最小的、安全的 Tag(没有 JavaScript)，去掉任何对远程内容的引用(尤其是样式表和 JavaScript)，使用 HTTPonly 的 cookie。
    ```

**SQL 注入**

`漏洞评级建议: 高危`

- 详情
    > 页面存在 SQL 注入漏洞,SQL 注入漏洞允许攻击者通过操纵用户输入来更改后端 SQL 语句。当 web 应用程序接受直接放入 SQL 语句的用户输入，并且没有正确过滤掉危险字符时，就会发生 SQL 注入。

- 造成的危害:
    > 攻击者可以在易受攻击的系统上执行任意 SQL 语句。根据正在使用的后端数据库， SQL 注入漏洞会导致攻击者访问不同级别的数据/系统。不仅可以操作现有查询，还可以合并任意数据、使用子选择或追加附加查询。在某些情况下，可以读入或写出文件，或者在底层操作系统上执行 shell 命令。 某些 SQL 服务器包含存储和扩展过程(数据库服务器功能)。如果攻击者能够获得这些程序的访问权限，可能会危及整个机器。

- 修复建议
    ```
    1. 程序代码里的所有查询语句，使用标准化的数据库查询语句 API 接口，设定语句的参数进行过滤一些非法的字符，防止用户输入恶意的字符传入到数据库中执行 sql 语句。
    2. 对用户提交的的参数安全过滤，像一些特殊的字符(，()*&……%# 等等)进行字符转义操作,以及编码的安全转换。
    3. 网站的报错信息尽量不要返回给客户端，比如一些字符错误，数据库的报错信息，尽可能的防止泄露给客户端。
    ```

### 中间件/服务

**Ghostcat(CVE-2020-1938)漏洞**

`漏洞评级建议: 高危`

- 详情
    >渗透测试过程中，发现目标存在Ghostcat漏洞。该漏洞允许黑客远程访问Apache Tomcat服务器，获取系统源代码。

- 造成的危害:

    >该漏洞位于Apache Tomcat软件的AJP协议中，该漏洞允许未经身份验证的攻击者远程访问服务器上部署的应用程序和源代码文件。

- 修复建议
    >针对 CVE-2020-1938 漏洞， Apache Tomca官方已放出相应的修复新版本，建议及时安装官方新版本。


**iis 短文件名泄露漏洞**

`漏洞评级建议: 高危`

- 详情
    > 目标存在 IIS 短文件名泄露漏洞。攻击者可利用此漏洞枚举网络服务器根目录中的文件。

- 造成的危害:
    > 攻击者可以利用该漏洞猜解后台地址和敏感文件甚至直接下载对应文件，或对 IIS 服务器中的 .Net Framework 进行拒绝服务攻击。

- 修复建议
    ```
    1. 升级 .net framework 至 4.0 版本或以上
    2. 修改 HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\FileSystem 值 NtfsDisable8dot3NameCreation 为 1
    ```

**Elasticsearch 未授权访问漏洞**

`漏洞评级建议: 高危`

- 漏洞描述：
    > 由于 Elasticsearch 授权模块需要付费，所以免费开源的 Elasticsearch 可能存在未授权访问漏洞。该漏洞导致，攻击者可以拥有 Elasticsearch 的所有权限。可以对数据进行任意操作。

- 危害：
    > 攻击者通常可以请求一个开放9200或9300的端口对服务器进行恶意攻击。业务系统将面临敏感数据泄露、数据丢失、数据遭到破坏甚至遭到攻击者的勒索。

- 修复建议：
    ```
    1. 限制 IP 访问，绑定固定 IP。
    2. 在 config/elasticsearch.yml 中为9200端口设置认证。
    ```

**XXX 中间件存在 XXX 远程代码执行漏洞**

`漏洞评级建议: 高危`

- 详情
    > 渗透测试过程中，发现目标站点存在 XXX 远程代码执行漏洞，该漏洞可以远程执行任意代码。

- 造成的危害:
    > 由于该漏洞影响范围较广，漏洞危害程度严重，可造成直接获取应用系统所在服务器的控制权限。

- 修复建议
    > 及时更新网站 XXX 应用或更新相应补丁。具体修复方案参考官方的安全公告

---

## 数据库

**Oracle 远程数据投毒漏洞(CVE-2012-1675)**

`漏洞评级建议: 低危`

- 详情
    > 服务器存在 oracle 远程数据投毒漏洞，该漏洞可以远程获取到 oracle 的内存信息，若是能获取到内存中的数据即为存在漏洞，进而可以再爆破 oracle 的 SID。

- 造成的危害:
    > 攻击者可以在不需要用户名密码的情况下利用网络中传送的数据消息(包括加密或者非加密的数据)，如果结合(CVE-2012-3137 漏洞进行密码破解)从而进一步影响甚至控制局域网内的任何一台数据库。

- 修复建议
    ```
    1. 不应该使用安装 Oracle 时默认的 SID(ORCL)，应该设置复杂度较高的 SID。
    2. 对于短时间内难以通过第1种方式修补漏洞的情况，应考虑加强主机和网络层面的访问控制策略。例如采用白名单的方式，仅允许授权主机 IP 访问该端口，避免漏洞被攻击者恶意利用。
    ```

**Redis 未授权访问漏洞**

`漏洞评级建议: 高危`

- 详情
    > Redis 默认情况下，会绑定在 0.0.0.0:6379，如果没有进行采用相关的策略，比如添加防火墙规则避免其他非信任来源 ip 访问等，这样将会将 Redis 服务暴露到公网上，如果在没有设置密码认证（一般为空）的情况下，会导致任意用户在可以访问目标服务器的情况下未授权访问 Redis 以及读取 Redis 的数据。

- 造成的危害:
    > 攻击者在未授权访问 Redis 的情况下，利用 Redis 自身的提供的config 命令，可以进行写文件操作，攻击者可以成功将自己的ssh公钥写入目标服务器的 /root/.ssh 文件夹的authotrized_keys 文件中，进而可以使用对应私钥直接使用ssh服务登录目标服务器、添加计划任务、写入Webshell等操作。

- 修复建议
    ```
    1. 禁止使用root权限启动redis服务。
    2. 对redis访问启动密码认证。
    3. 添加IP访问限制，并更改默认6379端口。
    ```

**Mongodb 未授权访问漏洞**

`漏洞评级建议: 高危`

- 详情
    > 目标 Mongodb 服务存在未授权访问漏洞，开启 MongoDB 服务时不添加任何参数时,默认是没有权限验证的,登录的用户可以通过默认端口无需密码对数据库任意操作（增、删、改、查高危动作）而且可以远程访问数据库。

- 造成的危害:
    > 使用默认空口令这将导致恶意攻击者无需进行账号认证就可以登陆到数据服务器。

- 修复建议
    ```
    1. 为MongoDB添加认证：MongoDB启动时添加--auth参数、为MongoDB添加用户
    2. MongoDB 自身带有一个HTTP服务和并支持REST接口。在2.6以后这些接口默认是关闭的。mongoDB默认会使用默认端口监听web服务，一般不需要通过web方式进行远程管理，建议禁用。修改配置文件或在启动的时候选择 –nohttpinterface 参数 nohttpinterface=false
    3. 启动时加入参数--bind_ip 127.0.0.1 或在/etc/mongodb.conf文件中添加以下内容：bind_ip = 127.0.0.1
    ```

**Memcahce 未授权访问**

`漏洞评级建议: 高危`

- 详情
    > 目标 Memcahce 服务存在未授权访问漏洞,Memcached 端口对外开放并且没有配置认证选项，未授权用户可直接获取数据库中所有信息，造成严重的信息泄露。

- 造成的危害:
    > 除 memcached 中数据可被直接读取泄漏和恶意修改外，由于 memcached 中的数据像正常网站用户访问提交变量一样会被后端代码处理，当处理代码存在缺陷时会再次导致不同类型的安全问题。不同的是，在处理前端用户直接输入的数据时一般会接受更多的安全校验，而从 memcached 中读取的数据则更容易被开发者认为是可信的，或者是已经通过安全校验的，因此更容易导致安全问题。

- 修复建议
    ```
    1. 配置 memcached 监听本地回环地址 127.0.0.1。
    vim /etc/sysconfig/memcached
    OPTIONS="-l 127.0.0.1"  # 设置本地为监听
    /etc/init.d/memcached restart   # 重启服务

    2. 当 memcached 配置为监听内网 IP 或公网 IP 时， 使用主机防火墙(iptalbes、 firewalld 等)和 网络防火墙对 memcached 服务端口 进行过滤。
    ```

## 远程服务

**CVE-2018-15473 OpenSSH 用户枚举漏洞**

`漏洞评级建议: 低危`

- 详情
    > 通过向 OpenSSH 服务器发送一个错误格式的公钥认证请求，可以判断是否存在特定的用户名。如果用户名不存在，那么服务器会发给客户端一个验证失败的消息。如果用户名存在，那么将因为解析失败，不返回任何信息，直接中断通讯。

- 造成的危害:
    > 由于 SSH 本身的认证机制存在缺陷，导致攻击者可以使用字典，暴力枚举 SSH 存在的用户名(Username)。

- 修复建议
    > 升级 openssh。

## 文件服务

**CVE-1999-0554 目标主机 showmount -e 信息泄露**

`漏洞评级建议: 高危`

- 详情
    > 目标服务器由于错误的 nfs 配置，可以对目标主机进行"showmount -e"操作。

- 造成的危害:
    > NFS 服务配置漏洞将泄露目标主机大量敏感信息，比如目录结构。更糟糕的是，如果访问控制不严的话，攻击者有可能直接访问到目标主机上的数据。

- 修复建议
    ```
    1. 修改 NFS 配置文件，限制可以获取 NFS 输出列表的 IP 和用户。
    2. 除非绝对必要，请关闭 NFS 服务、MOUNTD。
    ```

## 分布式

**Hadoop 未授权访问漏洞**

`漏洞评级建议: 高危`

- 详情
    > 该问题产生是由于管理员在配置失误所致，导致直接开放了 Hadoop 机器 HDFS 的 50070 web 端口及部分默认服务端口。

- 造成的危害:
    > 黑客可以通过命令行操作多个目录下的数据，如进行删除，下载，目录浏览甚至命令执行等操作，产生极大的危害。

- 修复建议
    ```
    1. 如无必要，关闭 Hadoop Web 管理页面。
    2. 开启身份验证，防止未经授权用户访问。
    3. 设置“安全组”访问控制策略，将 Hadoop 默认开放的多个端口对公网全部禁止或限制可信任的 IP 地址才能访问包括 50070 以及 WebUI 等相关端口。
    ```

**ZooKeeper 未授权访问漏洞**

`漏洞评级建议: 高危`

- 详情
    > ZooKeeper 是一个分布式的，开放源码的分布式应用程序协调服务，是 Google 的 Chubby 一个开源的实现，是 Hadoop 和 Hbase 的重要组件。它是一个为分布式应用提供一致性服务的软件，提供的功能包括：配置维护、域名服务、分布式同步、组服务等。ZooKeeper 的目标就是封装好复杂易出错的关键服务，将简单易用的接口和性能高效、功能稳定的系统提供给用户。在通常情况下，zookeeper 允许未经授权的访问。

- 造成的危害:
    > 攻击者渗透中遇到 ZooKeeper 集群后，可以查找事务日志来获取 admin 的密码或者其他敏感资源的认证方法。用户或者客户端根本不需要任何的认证就可以连上 ZooKeeper 的服务端，并且可以对 znode 进行增删等操作。这样数据是非常不安全的，极易被攻击和篡改。

- 修复建议
    ```
    1. 修改 ZooKeeper 默认端口，采用其他端口服务。
    2. 添加访问控制，配置服务来源地址限制策略。
    3. 增加 ZooKeeper 的认证配置。
    ```

## 虚拟化

**Docker Remote API 未授权访问漏洞**

`漏洞评级建议: 高危`

- 详情：
    > 目标 Docker Remote API 配置不当可导致未授权访问，可被攻击者恶意利用。

- 危害：
   > 攻击者无需认证即可访问到 Docker 数据，可能导致敏感信息泄露，黑客也可以删除 Docker 上的数据。攻击者可进一步利用 Docker 自身特性，直接访问宿主机上的敏感信息，或对敏感文件进行修改，最终完全控制服务器。

- 修复方法：
    ```
    1. 修改 Docker Remote API 服务默认参数。
    2. 修改 Docker 的启动参数：定位到 DOCKER_OPTS 中的 tcp://0.0.0.0:2375，将0.0.0.0修改为127.0.0.1 或将默认端口 2375 改为自定义端口为 Remote API 设置认证措施。
    3. 设置防火墙策略。如果正常业务中 API 服务需要被其他服务器来访问，可以配置安全组策略或 iptables 策略，仅允许指定的 IP 来访问 Docker 接口。
    4. 修改 Docker 服务运行账号。请以较低权限账号运行 Docker 服务；另外，可以限制攻击者执行高危命令。
    ```

---

# 协议

**SNMP 默认团体字符串可被枚举**

`漏洞评级建议: 低危`

- 详情
    > 渗透测试过程中，发现目标 SNMP 服务配置了默认的团体字符串，snmp 是用来进行网络管理的。cacti 和 mrtg 等监控工具都是基于 snmp 协议。

- 造成的危害:
    > snmp 弱口令或者口令泄漏引起的安全问题:一是信息泄漏，二是设备的配置可能被修改从而被他人控制。

- 修复建议
    > 修改 SNMP 的默认团体字符串，使用强度更高的字符串。

**ssl 版本过低**

`漏洞评级建议: 信息`

- 详情：
    > SSL协议是HTTP的补充，使用加密等方法让HTTP更安全；TLS是基于SSL v3的升级版协议，目前版本发展为v1.0 v1.1 v1.2。当前TLS版本过低，存在许多严重漏洞，这些漏洞使得目标存在被攻击的风险。

- 造成的危害：
    > 使用老旧的弱加密算法，信息将存在被中间人攻击和窃取的风险。

- 修复建议：
    > 使用严格的https证书，升级ssl到最新的版本。

---

# 安卓

**Web 组件远程代码执行漏洞**
- 描述:
    > 该危险 api 可通过 webview 对象向页面 javascript 导出 java 本地接口，可能导致任意命令执行。

- 修复建议：
    > 建议禁用危险接口 API 导出 Java 类和方法，并加强访问的 url 的域控制；

**https 敏感数据劫持漏洞**
- 描述:
    > 危险api不正确使用https相关函数，可能引发通信加密失效，导致敏感数据泄漏.

- 修复建议：
    > 建议对自定义的 X509TrustManager 实现对证书的严格校验；API 接口请设置安全选项级别

**应用数据任意备份风险**
- 描述:
    > Android 2.1以上的系统可为App提供应用程序数据的备份和恢复功能，该由 AndroidMainfest.xml 文件中的 allowBackup 属性值控制，其默认值为 true。当该属性没有显式设置为false时,攻击者可通过adb backup和adb restore对App的应用数据进行备份和恢复,从而可能获取明文存储的用户敏感信息，如用户的密码、证件号、手机号、交易密码、身份令牌、服务器通信记录等。利用此类信息攻击者可伪造用户身份，盗取用户账户资产，或者直接对服务器发起攻击。

- 修复建议：
    > 关闭 AndroidManifest.xml 中的组件导出权限，对于必须导出的组件必须限制于授权用户或者应用组件。建议再 AndroidManifest.xml 中把 android:debuggable 和 android:allowBackup 属性显式设置为 false

**敏感函数调用风险**
- 描述:
    > 敏感行为包括发送、拦截短信，读取、修改通讯录、通话记录，拨打电话，发送地理位置，使用摄像头，访问浏览器历史记录等。函数调用这些敏感行为，可能导致用户隐私数据泄露，钓鱼扣费等风险。

- 修复建议：
    > 审核包含敏感行为的函数调用，确保其使用是必要且限制于授权用户的。

**调试日志函数调用风险**
- 描述:
    > 调试日志函数可能输出重要的日志文件，其中包含的信息可能导致客户端用户信息泄露，暴露客户端代码逻辑等，为发起攻击提供便利，例如：Activity 的组件名，是 Activity 劫持需要的信息；通信交互的日志，会成为发动服务器攻击的依据；跟踪的变量值，可能泄露一些敏感数据，输入的账号、密码等。

- 修复建议：
    > 关闭调试日志函数调用，或者确保日志的输出使用了正确的级别，涉及敏感数据的日志信息在发布版本中被关闭。

**内网测试信息残留漏洞**
- 描述:
    > 通过检测是否包含内网 URl 地址,判断是否发布包中是否包含测试数据。残留的测试数据，例如 URL 地址，测试账号，密码，可能会被盗取并恶意利用在正式服务器上进行攻击，例如账号重试，攻击安全薄弱的测试服务器以获取服务器安全漏洞或者逻辑漏洞。

- 修复建议：
    > 建议开发者根据测评结果检测相关文件中是否包含更多的测试数据。
